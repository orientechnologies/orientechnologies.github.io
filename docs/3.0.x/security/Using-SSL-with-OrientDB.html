<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Secure SSL connections - OrientDB</title>


        <!-- Custom HTML head -->

        <meta name="description" content="OrientDB documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OrientDB</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="ssltls"><a class="header" href="#ssltls">SSL/TLS</a></h1>
<p>Beginning with version 1.7, OrientDB provides support for securing its HTTP and BINARY protocols through SSL.  For distributed SSL, see the HazelCast documentation.</p>
<p>Note that wherever SSL is referenced know that TLS 1.2 is enforced.</p>
<p>For more information on securing OrientDB, see the following pages:</p>
<ul>
<li><a href="Database-Security.html">Database security</a></li>
<li><a href="Server-Security.html">Server security</a></li>
<li><a href="Database-Encryption.html">Database Encryption</a></li>
</ul>
<h2 id="setting-up-the-key-and-trust-stores"><a class="header" href="#setting-up-the-key-and-trust-stores">Setting up the Key and Trust Stores</a></h2>
<p>In order to set up and manage certificates, OrientDB uses the Java Keytool.  Using certificates signed by a Certificate Authority (CA) is beyond the scope of this tutorial.  For more information on using the Java Keytool, see the <a href="http://docs.oracle.com/javase/7/docs/technotes/tools/index.html#security">Documentation</a>.</p>
<p>To create key and trust stores that reference a self-signed certificate, use the following guide:</p>
<ol>
<li>
<p>Using Keytool, create a certificate for the server:</p>
<pre>
# <code class="lang-sh userinput">keytool -genkey -alias server -keystore orientdb.ks \
     -keyalg RSA -keysize 2048 -validity 3650</code>
</pre>
</li>
<li>
<p>Export the server certificate to share it with client:</p>
<pre>
# <code class="lang-sh userinput">keytool -export -alias server -keystore orientdb.ks \
       -file orientdb.cert</code>
</pre>
</li>
<li>
<p>Create a certificate/keystore for the console/clients:</p>
<pre>
# <code class="lang-sh userinput">keytool -genkey -alias console -keystore orientdb-console.ks \
       -keyalg RSA -keysize 2048 -validity 3650</code>
</pre>
</li>
<li>
<p>Create a trust-store for the client, then import the server certificate.</p>
<pre>
# <code class="lang-sql userinput">keytool -import -alias server -keystore orientdb-console.ts \
       -file orientdb.cert</code>
</pre>
<p>This establishes that the client trusts the server.</p>
</li>
</ol>
<p>You now have a self-signed certificate to use with OrientDB.  Bear in mind that for each remote client JVM you want to connect to the server, you need to repeat steps three and four.  Remember to change the alias, keystore and trust-store filenames accordingly.</p>
<h2 id="configuring-orientdb-for-ssl"><a class="header" href="#configuring-orientdb-for-ssl">Configuring OrientDB for SSL</a></h2>
<h3 id="server-configuration"><a class="header" href="#server-configuration">Server Configuration</a></h3>
<p>The server configuration file, <code>$ORIENTDB_HOME/config/orientdb-server-config.xml</code>, does not use SSL by default.  To enable SSL on a protocol listener, you must change the <code>socket</code> attribute to the <code>&lt;listener&gt;</code> value from <code>default</code> to one of your configured <code>&lt;socket&gt;</code> definitions.</p>
<p>There are two default definitions available: <code>ssl</code> and <code>https</code>.  For most use cases this is sufficient, however you can define more if you want to secure different listeners with their own certificates or would like to use a custom factory implementations. When using the <code>ssl</code> implementation, bear in mind that the default port for OrientDB SSL is <code>2434</code>.  You need to change your port range to <code>2434-2440</code>.</p>
<p>By default, the OrientDB server looks for its keys and trust-stores in <code>$ORIENTDB_HOME/config/cert</code>.  You can configure it using the <code>&lt;socket&gt;</code> parameters.  Be sure that all the key and trust-stores created in the previous setup are in the correct directory and that the passwords used are correct.</p>
<blockquote>
<p><strong>NOTE</strong>: Paths are relative to <code>$ORIENTDB_HOME</code>.  OrientDB also supports absolute paths.</p>
</blockquote>
<pre><code class="language-xml">&lt;sockets&gt;
  &lt;socket implementation="com.orientechnologies.orient.server.network.OServerSSLSocketFactory" name="ssl"&gt;
    &lt;parameters&gt;
      &lt;parameter value="false" name="network.ssl.clientAuth"/&gt;
      &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.keyStore"/&gt;
      &lt;parameter value="password" name="network.ssl.keyStorePassword"/&gt;
       &lt;!-- NOTE: We are using the same store for keys and trust.
        	This will change if client authentication is enabled. See Configuring Client section --&gt;

      &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.trustStore"/&gt;
      &lt;parameter value="password" name="network.ssl.trustStorePassword"/&gt;
    &lt;/parameters&gt;
  &lt;/socket&gt;

  ...

  &lt;listener protocol="binary" ip-address="0.0.0.0" port-range="2424-2430" socket="default"/&gt;
  &lt;listener protocol="binary" ip-address="0.0.0.0" port-range="2434-2440" socket="ssl"/&gt;
</code></pre>
<h3 id="console-configuration"><a class="header" href="#console-configuration">Console Configuration</a></h3>
<p>For remote connections using the console, you need to make a few changes to to <code>console.sh</code>, enable SSL:</p>
<ol>
<li>
<p>Confirm that your <code>KEYSTORE</code>, <code>TRUSTSTORE</code> and respective <code>PASSWORD</code> variables are correctly set.</p>
</li>
<li>
<p>In the <code>SSL_OPTS</code> definition, set <code>client.ssl.enabled</code> system property to <code>true</code>.</p>
</li>
</ol>
<h3 id="client-configuration"><a class="header" href="#client-configuration">Client Configuration</a></h3>
<p>To configure remote clients, use the standard Java system property patterns:</p>
<ul>
<li><code>client.ssl.enabled</code>: Use this to enable/disable SSL.  The property accepts <code>true</code> or <code>false</code>.  You only need to define this when using remote binary client connections.</li>
<li><code>javax.net.ssl.keyStore</code>: Define the path to the keystore.</li>
<li><code>javax.net.ssl.keyStorePassword</code>: Defines the password to the keystore.</li>
<li><code>javax.net.ssl.trustStore</code>: Defines the path to the trust-store.</li>
<li><code>javax.net.ssl.trustStorePassword</code>: Defines the password to the trust-store.</li>
</ul>
<p>Use the third and fourth steps from <a href="Using-SSL-with-OrientDB.html#setting-up-the-key-and-trust-stores">Setting up the Key and Trust Stores</a> section above to create the client certificates and server trust.  The paths to the stores are client specific, but do not need to be the same as the server.</p>
<p>Note, if you would like to use key and/ore trust-stores other than that of the default JVN, you need to define the following variables as well:</p>
<ul>
<li><code>client.ssl.keyStore</code>: Defines the path to the keystore.</li>
<li><code>client.ssl.keyStorePass</code>: Defines the keystore password.</li>
<li><code>client.ssl.trustStore</code>: Defines the path to the trust-store.</li>
<li><code>client.ssl.trustStorePass</code>: Defines the password to the trust-store.</li>
</ul>
<p>Consider the following example, configuring SSL from the command-line through Java:</p>
<pre>
$ <code class="lang-sh userinput">java -Dclient.ssl.enabled=false \
      -Djavax.net.ssl.keyStore=</path/to/keystore> \
      -Djavax.net.ssl.keyStorePassword=<keystorepass> \  
      -Djavax.net.ssl.trustStore=</path/to/truststore> \
      -Djavax.net.ssl.trustStorePassword=<truststorepass></code>
</pre>
<p>As an alternative, you can define these variables through the Java API:</p>
<pre><code class="language-java">System.setProperty("client.ssl.enabled", &lt;"true"|"false"&gt;); # This will only be needed for remote binary clients
System.setProperty("javax.net.ssl.keyStore", &lt;/path/to/keystore&gt;);
System.setProperty("javax.net.ssl.keyStorePassword", &lt;keystorepass&gt;);
System.setProperty("javax.net.ssl.trustStore", &lt;/path/to/truststore&gt;);
System.setProperty("javax.net.ssl.trustStorePassword", &lt;truststorepass&gt;);
</code></pre>
<p>To verify or authenticate client certificates, you need to take a few additional steps on the server:</p>
<ol>
<li>
<p>Export the client certificate, so that you can share it with the server:</p>
<pre>
# <code class="lang-sh userinput">keytool -export -alias <client_alias> \
      -keystore <client.ks> -file client_cert</code>
</pre>
<p>Alternatively, you can do this through the console:</p>
<pre>
# <code class="lang-sh userinput">keytool -export -alias console -keystore orientdb-console.ks \
      -file orientdb-console.cert</code>
</pre>
</li>
<li>
<p>If you do not have a trust-store for the server, create one and import the client certificate.  This establishes that the server trusts the client:</p>
<pre>
# <code class="lang-sh userinput">keytool -import -alias <client_alias> -keystore orientdb.ts \
      -file client_cert</code>
</pre>
<p>Alternatively, you can manage the same through the console:</p>
<pre>
# <code class="lang-sh userinput">keytool -import -alias console -keystore orientdb.ts \ 
      -file orientdb-console.cert</code>
</pre>
</li>
</ol>
<p>In the server configuration file, ensure that you have client authentication enabled for the <code>&lt;socket&gt;</code> and that the trust-store path and password are correct:</p>
<pre><code class="language-xml">  &lt;sockets&gt;
    &lt;socket implementation="com.orientechnologies.orient.server.network.OServerSSLSocketFactory" name="ssl"&gt;
      &lt;parameters&gt;
        &lt;parameter value="true" name="network.ssl.clientAuth"/&gt;
        &lt;parameter value="config/cert/orientdb.ks" name="network.ssl.keyStore"/&gt;
        &lt;parameter value="password" name="network.ssl.keyStorePassword"/&gt;

        &lt;!-- NOTE: We are using the trust store with the imported client cert. You can import as many client as you would like --&gt;
        &lt;parameter value="config/cert/orientdb.ts" name="network.ssl.trustStore"/&gt;
        &lt;parameter value="password" name="network.ssl.trustStorePassword"/&gt;
      &lt;/parameters&gt;
    &lt;/socket&gt;
    ...
&lt;/sockets&gt;
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../security/Database-Encryption.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../security/Security-Config.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../security/Database-Encryption.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../security/Security-Config.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
