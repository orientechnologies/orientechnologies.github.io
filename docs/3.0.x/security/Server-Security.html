<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Server security - OrientDB</title>


        <!-- Custom HTML head -->

        <meta name="description" content="OrientDB documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OrientDB</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="server-security"><a class="header" href="#server-security">Server Security</a></h1>
<p>Individual OrientDB servers can manage multiple databases at a time and each database can have its own set of users.  When using OrientDB through the HTTP protocol, the OrientDB server uses one realm per database.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td><img src="../images/warning.png" alt="" /></td><td>While OrientDB can function as a regular Web Server, it is not recommended that you expose it directly to the internet or to public networks.  Instead, always hide the OrientDB server within a private network.</td></tr>
</tbody></table>
</div>
<p>Server users are stored in the <code>config/orientdb-server-config.xml</code> configuration file, in the <code>&lt;users&gt;</code> element.</p>
<pre><code class="language-xml">    &lt;users&gt;
        &lt;user name="root" password="{PBKDF2WithHmacSHA256}55F3DEAE:DLJEJFDKY8:65536" resources="*" /&gt;
        &lt;user name="guest" password="{PBKDF2WithHmacSHA256}B36E7993C961:C8C8B36F3:65536" resources="connect,server.listDatabases,server.dblist" /&gt;
    &lt;/users&gt;
</code></pre>
<p>When the OrientDB server starts for the first time, it creates the user <code>root</code> automatically, by asking you to give the password in the terminal.  In the event that you do not specify a password, OrientDB generates a random password.  Beginning with version 2.2, OrientDB hashes the passwords using <code>PBKDF2WithHmacSHA256</code> algorithm if it's running on Java 8 or major, otherwise <code>PBKDF2WithHmacSHA1</code> with a configurable SALT.</p>
<p>For more information on security in Orientdb, see:</p>
<ul>
<li><a href="Database-Security.html">Database security</a></li>
<li><a href="Database-Encryption.html">Database Encryption</a></li>
<li><a href="Using-SSL-with-OrientDB.html">Secure SSL connections</a></li>
</ul>
<h2 id="configuration"><a class="header" href="#configuration">Configuration</a></h2>
<p>While the default users and passwords are fine while you are setting your system up, it would be inadvisable to leave them in production.  To help restrict untrusted  users from accessing the OrientDB server, add a new user and change the passwords in the <code>config/orientdb-server-config.xml</code> server configuration file.</p>
<p>To restrict unauthorized users from giving themselves privileges on the OrientDB server, disable write-access to the configuration file.  To help prevent them from viewing passwords, disable read-access as well.  Note that even if the passwords are hashed, there are many techniques available to crack the hash or otherwise guess the real password.</p>
<div class="table-wrapper"><table><thead><tr><th></th><th></th></tr></thead><tbody>
<tr><td><img src="../images/warning.png" alt="" /></td><td>It is strongly recommended that you allow read/write access to the entire <code>config</code> directory only to the user that starts the OrientDB server.</td></tr>
</tbody></table>
</div>
<h2 id="managing-users"><a class="header" href="#managing-users">Managing Users</a></h2>
<p>Beginning with version 2.2, the OrientDB console provides a series of commands for managing users:</p>
<ul>
<li><a href="../console/Console-Command-List-Server-Users.html"><code>LIST SERVER USERS</code></a>: Displays all users.</li>
<li><a href="../console/Console-Command-Set-Server-User.html"><code>SET SERVER USER</code></a>: Creates or modifies a user.</li>
<li><a href="../console/Console-Command-Drop-Server-User.html"><code>DROP SERVER USER</code></a>: Drops a user.</li>
</ul>
<h2 id="server-resources"><a class="header" href="#server-resources">Server Resources</a></h2>
<p>Each user can declare which resources have access.  The wildcard <code>*</code> grants access to any resource.  By default, the user <code>root</code> has all privileges (<code>*</code>), so it can access all the managed databases and operations.</p>
<div class="table-wrapper"><table><thead><tr><th>Resources</th><th>Permission to</th></tr></thead><tbody>
<tr><td><code>database.create</code></td><td>Create a new database in the server</td></tr>
<tr><td><code>database.drop</code></td><td>Drop a database</td></tr>
<tr><td><code>database.exists</code></td><td>Check the existence of a database</td></tr>
<tr><td><code>database.freeze</code></td><td>Freeze the access to a database</td></tr>
<tr><td><code>database.release</code></td><td>Release a frozen database</td></tr>
<tr><td><code>database.passthrough</code></td><td>Allow access to all managed databases</td></tr>
<tr><td><code>server.config.get</code></td><td>Retrieve server's setting</td></tr>
<tr><td><code>server.config.set</code></td><td>Update server's setting</td></tr>
<tr><td><code>server.connect</code></td><td>Connect to a server</td></tr>
<tr><td><code>server.info</code></td><td>Retrieve server's information and statistics</td></tr>
<tr><td><code>server.listDatabases</code></td><td>Enlist available databases on the server</td></tr>
<tr><td><code>server.listDatabases.system</code></td><td>Include the OSystem database in the list of databases</td></tr>
<tr><td><code>server.replication</code></td><td>Execute a replication command from another server</td></tr>
<tr><td><code>server.replication.start</code></td><td>Start the replication of a database</td></tr>
<tr><td><code>server.replication.stop</code></td><td>Stop the replication of a database</td></tr>
<tr><td><code>server.replication.config</code></td><td>Update the replication configuration</td></tr>
<tr><td><code>server.shutdown</code></td><td>Shutdown a server</td></tr>
</tbody></table>
</div>
<p>For example,</p>
<pre><code class="language-xml">&lt;user name="replicator" password="repl" resources="database.passthrough"/&gt;
</code></pre>
<h2 id="securing-connections-with-ssl"><a class="header" href="#securing-connections-with-ssl">Securing Connections with SSL</a></h2>
<p>Beginning with version 1.7, you can further improve security on your OrientDB server by securing connections with SSL.  For more information on implementing this, see <a href="Using-SSL-with-OrientDB.html">Using SSL</a>.</p>
<h2 id="restoring-the-user-admin"><a class="header" href="#restoring-the-user-admin">Restoring the User admin</a></h2>
<p>In the event that something happens and you drop the class <code>OUser</code> or the user <code>admin</code>, you can use the following procedure to restore the user to your database.</p>
<ol>
<li>
<p>Ensure that the database is in the OrientDB server database directory, <code>$ORIENTDB_HOME/database/ folder</code>.</p>
</li>
<li>
<p>Launch the console or studio and log into the database with the user <code>root</code>.</p>
<pre>
$ <code class="lang-sh userinput"> $ORIENTDB_HOME/bin/console.sh</code>

OrientDB console v.X.X.X (build 0) www.orientdb.com
Type 'HELP' to display all the commands supported.
Installing extensions for GREMLIN language v.X.X.X

orientdb> <code class="lang-sql userinput">CONNECT remote:localhost/my_database root rootpassword</code>
</pre>
</li>
<li>
<p>Check that the class <code>OUser</code> exists:</p>
<pre>
orientdb> <code class="lang-sql userinput">SELECT FROM OUser WHERE name = 'admin'</code>
</pre>
<ul>
<li>
<p>In the event that this command fails because the class <code>OUser</code> doesn't exist, create it:</p>
<pre>
orientdb> <code class="lang-sql userinput">CREATE CLASS OUser EXTENDS OIdentity</code>
</pre>
</li>
<li>
<p>In the event that this command fails because the class `OIdentity doesn't exist, create it first:</p>
<pre>
orinetdb> <code class="lang-sql userinput">CREATE CLASS OIdentity</code>
</pre>
<p>Then repeat the above command, creating the class <code>OUser</code></p>
</li>
</ul>
</li>
<li>
<p>Check that the class <code>ORole</code> exists.</p>
<pre>
orientdb> <code class="lang-sql userinput">SELECT FROM ORole WHERE name = 'admin'</code>
</pre>
<ul>
<li>
<p>In the event that the class <code>ORole</code> doesn't exist, create it:</p>
<pre>
orientdb> <code class="lang-sql userinput">CREATE CLASS ORole EXTENDS OIdentity</code>
</pre>
</li>
</ul>
</li>
<li>
<p>In the event that the user or role <code>admin</code> doesn't exist, run the following commands:</p>
<ul>
<li>
<p>In the event that the role <code>admin</code> doesn't exist, create it:</p>
<pre>
orientdb> <code class="lang-sql userinput">INSERT INTO ORole SET name = 'admin', mode = 1, 
          rules = { "database.bypassrestricted": 15 }</code>
</pre>
</li>
<li>
<p>In the event that the user <code>admin</code> doesn't exist, create it:</p>
<pre>
orientdb> <code class="lang-sql userinput">INSERT INTO OUser SET name = 'admin', 
          password = 'my-admin_password', status = 'ACTIVE', 
          rules = ( SELECT FROM ORole WHERE name = 'admin' )</code>
</pre>
</li>
</ul>
</li>
</ol>
<p>The user <code>admin</code> is now active again on your database.</p>
<h2 id="restoring-the-servers-user-root"><a class="header" href="#restoring-the-servers-user-root">Restoring the Server's User root</a></h2>
<ol>
<li>Open the <code>config/orientdb-server-config.xml</code> file and remove the "root" user entry</li>
<li>Remove the tag <code>&lt;isAfterFirstTime&gt;true&lt;/isAfterFirstTime&gt;</code> at the end of the file</li>
<li>On next restart of the server, a new root password is asked again</li>
</ol>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../security/Database-Security.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../security/Database-Encryption.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../security/Database-Security.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../security/Database-Encryption.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
