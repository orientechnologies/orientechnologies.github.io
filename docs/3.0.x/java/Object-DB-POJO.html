<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>POJO - OrientDB</title>


        <!-- Custom HTML head -->

        <meta name="description" content="OrientDB documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OrientDB</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="working-with-pojo"><a class="header" href="#working-with-pojo">Working with POJO</a></h1>
<p>With the Object API, Plain Old Java Objects, or POJO's, are automatically bound to the database as documents.  For information on the particulars of object-to-record bindings, see <a href="Object-2-Record-Java-Binding.html">POJO Bindings</a>.</p>
<blockquote>
<p>Bear in mind that the behavior of POJO operations can vary depending on whether you've begun a transaction.  For more information, see <a href="../internals/Transactions.html">Transactions</a>.</p>
</blockquote>
<h2 id="working-with-records"><a class="header" href="#working-with-records">Working with Records</a></h2>
<p>The best practice in creating Java objects is to use the <code>newInstance()</code> method on the <code>ODatabaseObject</code> object.  For instance,</p>
<pre><code class="language-java">public class Person {
   private String name;
   private String surname;

   public Person() {}

   public Person(String name){
      this.name = name;
   }

   public Person(String name, String surname){
      this.name = name;
      this.surname = surname;
   }

   //getters and settss
}
OrientDBObject orientDB = new OrientDBObject("remote:localhost",OrientDBConfig.defaultConfig());

ODatabaseObject db = orientDB.open("petshop",admin", "admin_passwd");

db.getEntityManager().registerEntityClass(Person.class);

// CREATES NEW PERSON FROM EMPTY CONSTRUCTOR
Person person = db.newInstance(Person.class);
person.setName("Antoni");
person.setSurname("Gaudi");
db.save(person);

// CREATES A NEW PERSON FROM A PARAMETERIZED CONSTRUCTOR
Person person = db.newInstance(Person.class, "Antoni");
person.setSurname("Gaudi");
db.save(person);

// OR
Person person = db.newInstance(Person.class, "Antoni", "Gaudi");
db.save(person);
</code></pre>
<p>Note that any Java object can be saved by calling the <code>db.save()</code> method.  If it doesn't exist in the database, OrientDB serializes and saves it.  In this case, the user must assign the results of the <code>db.save()</code> method in the argument in order to get the proxied instance.  Otherwise, the database always treats the object as a new one.  For instance,</p>
<pre><code class="language-java">// REGISTER THE CLASS ONLY ONCE AFTER THE DB IS OPEN/CREATED
db.getENtityManager().registerEntityClass(Animal.class);

Animal animal = new Animal();
animal.setName("Gaudi");
animal.setLocation("Madrid");
animal = db.save(animal);
</code></pre>
<h3 id="browsing-and-counting-records"><a class="header" href="#browsing-and-counting-records">Browsing and Counting Records</a></h3>
<p>With the Object API, you can browse or count records in the database from your application, either all records in a cluster or in a particular class.  For instance,</p>
<ul>
<li>
<p><strong>Browsing Records by Class</strong>:</p>
<pre><code class="language-java">for (Object o: database.browseClass(Animal.class)){
   System.out.println(animal.getName());
}
</code></pre>
</li>
<li>
<p><strong>Counting Records by Class</strong>:</p>
<pre><code class="language-java">long cars = database.countClass("Car");
</code></pre>
</li>
<li>
<p><strong>Browsing Records by Cluster</strong>:</p>
<pre><code class="language-java">for (Object o: database.browseCluster("CityCars")){
   System.out.println(((Car) o).getModel());
}
</code></pre>
</li>
<li>
<p><strong>Counting Records by Cluster</strong>:</p>
<pre><code class="language-java">long cityCars = database.countCluster("CityCar");
</code></pre>
</li>
</ul>
<h3 id="updating-objects"><a class="header" href="#updating-objects">Updating Objects</a></h3>
<p>You can update any proxied object by using the Java language and then calling the <code>db.save()</code> method to synchronize the changes with OrientDB.  This behavior varies depending on the transaction, if any.</p>
<p><strong>Syntax</strong></p>
<pre><code class="language-java">animal.setLocation("Nairobi");
db.save(animal);
</code></pre>
<p>OrientDB only updates fields that have actually been changed.</p>
<p><strong>Example</strong></p>
<p>For example, in the pet shop application you might use something like this to raise the cost of animals by 5%:</p>
<pre><code class="language-java">for (Animal animal: database.browseClass(Animal.class)) {
   animal.setPrice(animal.getPrice() * 105 / 100);
   database.save(animal);
}
</code></pre>
<p>When you call the <code>db.save()</code> method with non-proxied objects, the database creates a new document, even if said object were already saved.</p>
<h3 id="deleting-objects"><a class="header" href="#deleting-objects">Deleting Objects</a></h3>
<p>To delete an object, call the <code>db.delete()</code> method on a proxied object.  If you call it on a non-proxied object the database doesn't do anything.</p>
<p><strong>Syntax</strong></p>
<pre><code class="language-java">db.delete(animal);
</code></pre>
<p><strong>Example</strong></p>
<pre><code class="language-java">for (Animal animal: database.browseClass(Animal.class)){
   database.delete(animal);
}
</code></pre>
<p>Here, the application loops through every instance of the class <code>Animal</code> and deletes the record.</p>
<h4 id="cascade-deletions"><a class="header" href="#cascade-deletions">Cascade Deletions</a></h4>
<p>The Object API uses JPA annotations to manage cascade deletions.  It can be done explicitly, (that is, <code>orphanRemoval = true</code>), or with <code>CascadeType</code>.  The first mode works only with <code>@OneToOne</code> and <code>@OneToMany</code> annotations.  <code>CascadeType</code> works with <code>@ManyToManay</code> annotation.</p>
<p>For instance,</p>
<pre><code class="language-java">public class JavaCascadeDeleteTestClass {
  ...

  @OneToOne(orphanRemoval = true)
  private JavaSimpleTestClass  simpleClass;

  @ManyToMany(cascade = { CascadeType.REMOVE })
  private Map&lt;String, Child&gt;   children    = new HashMap&lt;String, Child&gt;();

  @OneToMany(orphanRemoval = true)
  private List&lt;Child&gt;          list = new ArrayList&lt;Child&gt;();

  @OneToMany(orphanRemoval = true)
  private Set&lt;Child&gt; set = new HashSet&lt;Child&gt;();
  ...

  // GETTERS AND SETTERS
}
</code></pre>
<p>This means that you can make these deletions by calling,</p>
<ul>
<li>
<pre><code class="language-java">database.delete(testClass);
</code></pre>
</li>
<li>
<pre><code class="language-java">for (JavaCascadeDeleteTestClass testClass: 
      database.browseClass(JavaCascadeDeleteTestClass.class)) {
database.delete(testClass);
}
</code></pre>
</li>
</ul>
<p>Here, you also delete <code>JavaSimpleTextClass</code> instances contained in the <code>simpleClass</code> field and all other documents contained in <code>children</code>, <code>list</code>, and <code>test</code>.</p>
<h2 id="executing-queries"><a class="header" href="#executing-queries">Executing Queries</a></h2>
<p>While OrientDB is a NoSQL database, it also supports a subset of SQL with extensions, allowing it to work with objects and graphs.  For more information, see <a href="../sql/README.html">SQL</a>.  For instance,</p>
<pre><code class="language-java">List&lt;Animal&gt; result = db.query(
   new OSQLSynchQuery&lt;Animal&gt;(
      "SELECT FROM Animal WHERE id = 10 AND name LIKE 'G%'"));
</code></pre>
<blockquote>
<p>OrientDB is a Graph database.  This means that it is very efficient at traversing records.  You can use this feature to optimize your queries.  A common technique for this is <a href="../sql/Pivoting-With-Query.html">Pivoting</a>.</p>
</blockquote>
<p>To execute SQL commands, use the <code>command()</code> method with an <code>OCommandSQL</code> object.  For instance,</p>
<pre><code class="language-java">int recordsUpdated = db.command(
   new OCommandSQL("UPDATE Animal SET sold = false"))
   .execute();
</code></pre>
<h2 id="getting-odocument-from-a-pojo"><a class="header" href="#getting-odocument-from-a-pojo">Getting ODocument from a POJO</a></h2>
<p>The <code>ODatabaseObject</code> implementation has APIs to get a document from its referencing object:</p>
<pre><code class="language-java">ODocument doc = db.getRecordByUserObject( animal );
</code></pre>
<p>In case of non-proxied objects the document will be a new generated one with all object field serialized in it.</p>
<h2 id="getting-pojo-from-records"><a class="header" href="#getting-pojo-from-records">Getting POJO from Records</a></h2>
<p>The Object database can also create objects from records:</p>
<pre><code class="language-java">Object pojo = db.getUserObjectsByRecord(record);
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../java/Object-DB-Interface.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../java/Object-DB-Attach.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../java/Object-DB-Interface.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../java/Object-DB-Attach.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
