<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Document API - OrientDB</title>


        <!-- Custom HTML head -->

        <meta name="description" content="OrientDB documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OrientDB</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="document-api"><a class="header" href="#document-api">Document API</a></h1>
<blockquote>
<p>In case of embedded GroupId: <strong>com.orientechnologies</strong>  ArtifactId: <strong>orientdb-core</strong></p>
</blockquote>
<blockquote>
<p>In case of remote GroupId: <strong>com.orientechnologies</strong>  ArtifactId: <strong>orientdb-client</strong></p>
</blockquote>
<p>The Document Database in OrientDB is the foundation of higher level implementations, like the <a href="Object-Database.html">Object Database</a> and the <a href="Graph-Database-Tinkerpop.html">Tinkerpop Graph</a>.  The Document API supports:</p>
<ul>
<li><a href="Java-Multi-Threading.html">Multi-thread Access</a></li>
<li><a href="../internals/Transactions.html">Transactions</a></li>
<li><a href="Document-API-Documents.html#retrieving-documents">Queries</a></li>
<li><a href="Document-API-Documents.html#traversing-documents">Traverse</a></li>
</ul>
<pre><code class="language-java">// OPEN THE DATABASE
OrientDB orientDB = new OrientDB("remote:localhost");
ODatabaseDocument db = orientDB.open("petshop","admin", "admin_passwd");

// CREATE A NEW DOCUMENT AND FILL IT
ODocument doc = new ODocument("Person");
doc.field( "name", "Luke" );
doc.field( "surname", "Skywalker" );
doc.field( "city", new ODocument("City")
   .field("name","Rome")
   .field("country", "Italy") );

// SAVE THE DOCUMENT
db.save(doc);

db.close();
orientDB.close();
</code></pre>
<blockquote>
<p>For more information, see</p>
<ul>
<li>Javadoc: <a href="http://www.orientechnologies.com/javadoc/latest/">JavaDoc</a></li>
<li><a href="../studio/README.html">OrientDB Studio Web tool</a>.</li>
</ul>
</blockquote>
<h2 id="using-the-document-database"><a class="header" href="#using-the-document-database">Using the Document Database</a></h2>
<p>In order to work with documents in your application, you first need to open a database and create an instance in your code.  For instance, when opening on localhost through the <code>remote</code> interface, you might use something like this:</p>
<pre><code class="language-java">OrientDB orientDB = new OrientDB("remote:localhost");
ODatabaseDocument db = orientDB.open("petshop","admin", "admin_passwd");
</code></pre>
<p>Once you have the database open, you can create, update and delete documents, as well as query document data to use in your application.</p>
<blockquote>
<p>For more information, see</p>
<ul>
<li><a href="Document-API-Database.html">Working with Document Databases</a></li>
<li><a href="Document-API-Documents.html">Working with Documents</a></li>
</ul>
</blockquote>
<h3 id="creating-documents"><a class="header" href="#creating-documents">Creating Documents</a></h3>
<p>You can create documents through the <code>ODocument</code> object by setting up the document instance and then calling the <code>save()</code> method on that instance.  For instance,</p>
<pre><code class="language-java">ODocument animal = new ODocument("Animal");
animal.field("name", "Gaudi");
animal.field("location", "Madrid");
animal.save()
</code></pre>
<h3 id="updating-documents"><a class="header" href="#updating-documents">Updating Documents</a></h3>
<p>You can update persistent documents through the Java API by modifying the document instance and then calling <code>save()</code> on the database.  Alternatively, you can call <code>save()</code> on the document instance itself to synchronize the changes to the database.</p>
<pre><code class="language-java">animal.field( "location", "Nairobi" );
animal.save();
</code></pre>
<p>When you call <code>save()</code>, OrientDB only updates the fields you've changed.</p>
<blockquote>
<p><strong>NOTE</strong>: This behavior can vary depending on whether you've begun a transaction.  For more information, see <a href="../internals/Transactions.html">Transactions</a>.</p>
</blockquote>
<p>For instance, using the code below you can raise the price of animals by 5%:</p>
<pre><code class="language-java">for (ODocument animal : database.browseClass("Animal")) {
  animal.field("price", animal.field("price") * 1.05);
  animal.save();
}
</code></pre>
<h3 id="deleting-documents"><a class="header" href="#deleting-documents">Deleting Documents</a></h3>
<p>Through the Java API, you can delete documents through the <code>delete()</code> method on the loaded document instance. For instance,</p>
<pre><code class="language-java">animal.delete();
</code></pre>
<blockquote>
<p><strong>NOTE</strong>: This behavior can vary depending on whether you've begun a transaction.  For more information, see <a href="../internals/Transactions.html">Transactions</a>.</p>
</blockquote>
<p>For instance, using the code below you can delete all documents of the <code>Animal</code> class:</p>
<pre><code class="language-java">for (ODocument animal : database.browseClass("Animal")) {
   animal.delete();
}
</code></pre>
<h2 id="schema"><a class="header" href="#schema">Schema</a></h2>
<p>OrientDB is flexible when it comes to schemas.  You can use it,</p>
<ul>
<li><strong>Schema Full</strong>, such as in Relational Databases.</li>
<li><strong>Schema Less</strong>, such as with many NoSQL Document Databases.</li>
<li><strong>Scheme Hybrid</strong>, which mixes the two.</li>
</ul>
<blockquote>
<p>For more information, see <a href="../general/Schema.html">Schemas</a>.</p>
</blockquote>
<p>In order to use the schema with documents, create the <code>ODocument</code> instance with the constructor <code>ODocument(String className)</code>, passing it the class name as an argument.  If you haven't declared the class, OrientDB creates it automatically with no fields.  This won't work during transactions, given it can't apply schema changes in transactional contexts.</p>
<h2 id="security"><a class="header" href="#security">Security</a></h2>
<p>Few NoSQL implementations support security.  OrientDB does.  For more information on its security features, see <a href="../security/Security.html">Security</a>.</p>
<p>To manage the security from within the Java API, get the Security Manager and use it to operate on users and roles.  For instance,</p>
<pre><code class="language-java">OSecurity sm = db.getMetadata().getSecurity();
OUser user = sm.createUser(
   "john.smith", "smith_passwd",
   new String[]{"admin"});
</code></pre>
<p>Once you've have users on the database, you can retrieve information about them through the Java API:</p>
<pre><code class="language-java">OUser user = db.getUser();
</code></pre>
<h2 id="transactions"><a class="header" href="#transactions">Transactions</a></h2>
<p>Transactions provide you with a practical way to group sets of operations together.  OrientDB supports <a href="http://en.wikipedia.org/wiki/ACID">ACID</a> transactions, ensuring that either all operations succeed or none of them do.  The database always remains consistent.</p>
<blockquote>
<p>For more information, see <a href="../internals/Transactions.html">Transactions</a>.</p>
</blockquote>
<p>OrientDB manages transactions at the database-level.  Currently, it does not support nesting transactions.  A database instance can only have one transaction running at a time. It provides three methods in handling transactions:</p>
<ul>
<li><strong><code>begin()</code></strong> Starts a new transaction.  If a transaction is currently running, it's rolled back to allow the new one to start.</li>
<li><strong><code>commit()</code></strong>  Ends the transaction, making the changes persistent.  If an error occurs during the commit, the transaction is rolled back and it raises an <code>OTransactionException</code> exception.</li>
<li><strong><code>rollback()</code></strong> Ends the transaction and removes all changes.</li>
</ul>
<h3 id="optimistic-approach"><a class="header" href="#optimistic-approach">Optimistic approach</a></h3>
<p>In its current release, OrientDB uses <a href="../internals/Transactions.html#optimistic-transaction">Optimistic Transactions</a>, in which no lock is kept and all operations are checked on the commit.  This improves concurrency, but can throw an <code>OConcurrentModificationException</code> exception in cases where the records are modified by concurrent client threads.  In this scenario, the client code can reload the updated records and repeat the transaction.</p>
<p>When optimistic transactions run, all changes are kept in memory.  If you're using remote storage, the changes are sent to the server only when you executed a query or you call the <code>commit()</code> method.  All changes transfer in a block to reduce network latency, speed up the execution and increase concurrency.  This differs from most Relational Databases, where changes are sent immediately to the server during transactions.</p>
<h3 id="usage"><a class="header" href="#usage">Usage</a></h3>
<p>OrientDB commits transactions only when you call the <code>commit()</code> method and no errors occur.  The most common use case for transactions is to enclose all database operations within a <code>try</code>/<code>finally</code> blocks.  When you close the database, (that is, when your application executes the <code>finally</code> block), OrientDB automatically rolls back any pending transactions still running.</p>
<p>For instance,</p>
<pre><code class="language-java">OrientDB orientDB = new OrientDB("remote:localhost");

try (ODatabaseDocument db = orientDB.open("petshop","admin", "admin_passwd")) {
  db.begin();
  // YOUR CODE
  db.commit();
}

orientDB.close();
</code></pre>
<h2 id="index-api"><a class="header" href="#index-api">Index API</a></h2>
<blockquote>
<p>See also <a href="../indexing/Indexes.html">SQL Indices</a>.</p>
</blockquote>
<p>You can declare an index on a property or a group of properties this will make orient automatically index the documents of the specific class with the specific properties and automatically use the index in the queries, the way to declare this indexes is through the <a href="ref/OClass.html"><code>OClass</code></a> and <a href="ref/OProperty.html"><code>OProperty</code></a> API.</p>
<p>Index on a single property, For instance,</p>
<pre><code>OClass animalClass = database.getClass("Animal");
OProperty nameProp = animalClass.getProperty("name");
nameProp.createIndex(OClass.INDEX_TYPE.NOTUNIQUE);
</code></pre>
<p>This example will use as index name <code>&lt;class-name&gt;.&lt;property-name&gt;</code></p>
<p>Index on multiple properies, For Instance,</p>
<pre><code>OClass animalClass = database.getClass("Animal");
animalClass.createIndex("index_name", OClass.INDEX_TYPE.NOTUNIQUE, "name","location");
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../tinkerpop3/OrientDB-TinkerPop3.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../java/Document-API-Documents.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../tinkerpop3/OrientDB-TinkerPop3.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../java/Document-API-Documents.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
