<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Session API - OrientDB</title>


        <!-- Custom HTML head -->

        <meta name="description" content="OrientDB documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" id="highlight-css" href="../highlight.css">
        <link rel="stylesheet" id="tomorrow-night-css" href="../tomorrow-night.css">
        <link rel="stylesheet" id="ayu-highlight-css" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root and default themes to javascript -->
        <script>
            const path_to_root = "../";
            const default_light_theme = "light";
            const default_dark_theme = "navy";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="mdbook-help-container">
        <div id="mdbook-help-popup">
            <h2 class="mdbook-help-title">Keyboard shortcuts</h2>
            <div>
                <p>Press <kbd>←</kbd> or <kbd>→</kbd> to navigate between chapters</p>
                <p>Press <kbd>S</kbd> or <kbd>/</kbd> to search in the book</p>
                <p>Press <kbd>?</kbd> to show this help</p>
                <p>Press <kbd>Esc</kbd> to hide this help</p>
            </div>
        </div>
    </div>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                let theme = localStorage.getItem('mdbook-theme');
                let sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            const default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? default_dark_theme : default_light_theme;
            let theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            let sidebar = null;
            const sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="default_theme">Auto</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search (`/`)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="/ s" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OrientDB</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="session-api"><a class="header" href="#session-api">Session API</a></h1>
<p>A Session instance can be used for:</p>
<ul>
<li>Run a Query (Idempotent SQL statement)</li>
<li>Run a Command (Idempotent or non idempotent SQL statement)</li>
<li>Run a Batch Script</li>
<li>Execute a Transaction</li>
<li>Execute a live query</li>
<li>Use query builder</li>
</ul>
<p>To obtain a Session instance use the <a href="Client.html#sessions">Cient APIs</a>.</p>
<blockquote>
<p>By convention, the variable on which you initialize the Session API is called session. This designation is arbitrary and used only for convenience.</p>
</blockquote>
<h2 id="query"><a class="header" href="#query">Query</a></h2>
<p>The <code>session.query</code> method executes an idempotent SQL query against the opened database. You can either define these values directly in SQL, or define arbitrary parameters through additional arguments.
The API call returns an extension of Node.js Streams.</p>
<h3 id="streaming"><a class="header" href="#streaming">Streaming</a></h3>
<pre><code class="language-js">session.query("select from OUser where name = :name", {params: { name: "admin" }})
	.on("data", data =&gt; {
		console.log(data);
	})
	.on('error',(err)=&gt; {
	  console.log(err);
	})
	.on("end", () =&gt; {
		console.log("End of the stream");
	});
</code></pre>
<h3 id="to-promise"><a class="header" href="#to-promise">To Promise</a></h3>
<p>Use <code>.all</code> API that convert the stream to a Promise and collect the result set into an array</p>
<pre><code class="language-js">session.query("select from OUser where name = :name", { params : {name: "admin" }})
.all()
.then((results)=&gt; {
	console.log(results);
});
</code></pre>
<p>or with async/await</p>
<pre><code class="language-js">try {
	let results = await session
	.query("select from OUser where name = :name", {
		params: { name: "admin" }
	})
	.all();
	console.log(results);
} catch (e) {
	console.log(e);
}
</code></pre>
<p>Alternatevely use <code>.one</code> API for the first entry only</p>
<pre><code class="language-js">session.query("select from OUser where name = :name", { params : {name: "admin" }})
.one()
.then((results)=&gt; {
	console.log(results);
});
</code></pre>
<p>or with async/await</p>
<pre><code class="language-js">try {
	let results = await session
	.query("select from OUser where name = :name", {
		params: { name: "admin" }
	})
	.one();
	console.log(results);
} catch (e) {
	console.log(e);
}
</code></pre>
<h2 id="command"><a class="header" href="#command">Command</a></h2>
<p>The <code>session.command</code> method executes a SQL query against the opened database and accept non idempotent queries like <code>insert into</code>, <code>create vertex</code> etc.
The API call returns an extension of Node.js Streams.</p>
<pre><code class="language-js">session.command("insert into V set name = :name", {params: { name: "test" }})
.all()
.then(result =&gt; {
	console.log(result);
});
</code></pre>
<p>or with async/await</p>
<pre><code class="language-js">try {
	let results = await session
	.command("insert into V set name = :name", { params: { name: "test" } })
	.all();
	console.log(results);
} catch (e) {
	console.log(e);
}
</code></pre>
<h2 id="batch-script"><a class="header" href="#batch-script">Batch Script</a></h2>
<p>The <code>batch</code> method executes a Multiple SQL query against the opened database.
The API call returns an extension of Node.js Streams.</p>
<pre><code class="language-js">let batch = `begin;
	let $v1 = create vertex V set name = "first";
	let $v2 = create vertex V set name = "second";
	let $e = create edge E from $v1 to $v2;
	commit;
	return  $e;`;
	
session.batch(batch).all()
  .then(results =&gt; {
    console.log(results);
  });
</code></pre>
<p>or with async/await</p>
<pre><code class="language-js">try {
	let batch = `begin;
	let $v1 = create vertex V set name = "first";
	let $v2 = create vertex V set name = "second";
	let $e = create edge E from $v1 to $v2;
	commit;
	return  $e;`;

	let results = await session.batch(batch).all();
	console.log(results);
} catch (e) {
	console.log(e);
}
</code></pre>
<h2 id="querycommandscript-options"><a class="header" href="#querycommandscript-options">Query/Command/Script Options</a></h2>
<p>Those APIs accepts an options object as second paramenter.</p>
<p>The options can contains:</p>
<ul>
<li>Query parameters</li>
<li>Additional Configuration</li>
</ul>
<h3 id="using-parameters"><a class="header" href="#using-parameters">Using Parameters</a></h3>
<p>The options object can contain a <code>params</code> property that represent the query parameters to use.</p>
<h4 id="named-parameters"><a class="header" href="#named-parameters">Named parameters</a></h4>
<pre><code class="language-js">session.command("insert into V set name = :name", {params: { name: "test" }})
.all()
.then(result =&gt; {
	console.log(result);
});
</code></pre>
<h4 id="positional-parameters"><a class="header" href="#positional-parameters">Positional parameters</a></h4>
<pre><code class="language-js">session.command("insert into V set name = ?", {params: ["admin"]})
.all()
.then(result =&gt; {
	console.log(result);
});
</code></pre>
<h3 id="additional-configuration"><a class="header" href="#additional-configuration">Additional configuration</a></h3>
<p>Starting from OrientDB 3.0, the result set from a query/command/script is paginated. By default OrientJS uses a page size of <code>100</code> records.
Use the additional property <code>pageSize</code> to tune this configuration.</p>
<pre><code class="language-js">session.command("select name from V", {
	params: ["admin"],
	pageSize: 1000
})
.all()
.then(results =&gt; {
	console.log(results);
});
</code></pre>
<h2 id="transactions"><a class="header" href="#transactions">Transactions</a></h2>
<p>Use the api <code>session.runInTransaction</code> in order to run a unit of work in a managed transaction (begin/commit/retry). The unit of work provided in input should return a Promise. The return of <code>session.runInTransaction</code> is a Promise that once resolved, returns the result of the last operation in the unit of work and the result of the <code>commit</code> of the transaction.</p>
<blockquote>
<p>The Session supports only 1 transaction at time.
Use multiple sessions if you want to run concurrent transactions.</p>
</blockquote>
<pre><code class="language-js">session.runInTransaction((tx)=&gt;{
	return tx.command("insert into V set name = :name", {params: { name: "test" }})
	.all();
}).then(({result,tx}) =&gt; {
	console.log(result);
	console.log(tx);
});
</code></pre>
<p>alternativelly using explicit API</p>
<pre><code class="language-js">session.begin();
session.command("insert into V set name = :name", {
	params: { name: "admin" }})
	.one()
	.then(results =&gt; {
		console.log(results);
		return session.commit();
	})
	.then(results =&gt; {
		console.log(results);
	});
</code></pre>
<h2 id="live-queries"><a class="header" href="#live-queries">Live Queries</a></h2>
<p>When using traditional queries, such as those called with <code>session.query()</code> and <code>session.select()</code> you only get data that is current at the time the query is issued.  Beginning in version 2.1, OrientDB now supports <a href="../java/Live-Query.html">Live Queries</a>, where in issuing the query you tell OrientDB you want it to push affecting changes to your application.</p>
<p>You can execute Live Queries using the <code>session.liveQuery()</code> method with a <a href="../sql/SQL-Live-Select.html"><code>LIVE SELECT</code></a> statement passed as its argument.</p>
<h3 id="understanding-live-queries"><a class="header" href="#understanding-live-queries">Understanding Live Queries</a></h3>
<p>Traditional queries provide you with information that is current at the time the query is issued.  In most cases, such as well pulling statistical data on long-dead ball players like Ty Cobb, this behavior is sufficient to your needs.  But, what if about when you need real time information.</p>
<p>For instance, what if in addition to historical data you also want your application to serve real-time information about baseball games as they're being played.</p>
<p>With the traditional query, you would have to reissue the query within a set interval to update the application.  Live Queries allow you to register events, so that your application performs addition operations in the event of an <a href="../sql/SQL-Insert.html"><code>INSERT</code></a>, <a href="../sql/SQL-Delete.html"><code>DELETE</code></a>, or <a href="../sql/SQL-Update.html"><code>UPDATE</code></a>.</p>
<p>For example, say that you have a web application that uses the baseball database.  The application serves the current score and various other stats for the game.  Whenever your back-end system inserts new records for the game, you can execute a function to update the display information.</p>
<h3 id="working-with-live-queries"><a class="header" href="#working-with-live-queries">Working with Live Queries</a></h3>
<p>In OrientJS, Live Queries are called using the <code>session.liveQuery()</code> method.  This is similar to <code>session.query()</code> in that you use it to issue the raw SQL of a <a href="../sql/SQL-Live-Select.html"><code>LIVE SELECT</code></a> statement.  You can assign event handlers to <code>session.liveQuery</code> using the <code>on('data')</code> method. The methods returns an extension of Node.JS Streams</p>
<p>For instance,</p>
<pre><code class="language-js">session.liveQuery("select from V").on("data", data =&gt; {
	console.log(data);
});
</code></pre>
<p>The data object is emitted every time the live query is matched and it contains those properties</p>
<ul>
<li><strong>monitorId</strong> : identifier of the live query on the server.</li>
<li><strong>operation</strong> : identifier of the operation executed
<ul>
<li>1 - Create</li>
<li>2 - Update</li>
<li>3 - Delete</li>
</ul>
</li>
<li><strong>data</strong> : the actual matched record.</li>
<li><strong>before</strong> : in case of update, the previously version of the record changed.</li>
</ul>
<pre><code class="language-JSON">{ 
	monitorId: 275616756,
	operation: 1,
	data:
  		{ 
  			name: 'Foo',
     		'@rid': RecordID { cluster: 10, position: 12 },
     		'@class': 'V',
     		'@version': 1 
     	} 
}
</code></pre>
<h3 id="unsubscribing-live-queries"><a class="header" href="#unsubscribing-live-queries">Unsubscribing Live Queries</a></h3>
<p>To unsubscribe a live query, use the API <code>handle.unsubscribe</code> where
<code>handle</code> is the returned value of the <code>liveQuery</code> function</p>
<pre><code class="language-js">let handle = session.liveQuery("select from V").on("data", data =&gt; {
	console.log(data);
	handle.unsubscribe();
});
</code></pre>
<h2 id="query-builder"><a class="header" href="#query-builder">Query Builder</a></h2>
<p>Rather than writing out query strings in SQL, you can alternatively use the OrientJS Query Builder to construct queries using a series of methods connected through the Database API.</p>
<ul>
<li><strong>create</strong>: Creates vertices and edges.</li>
<li><strong>insert</strong>: Insert records</li>
<li><strong>update</strong>: Modifies records on database.</li>
<li><strong>delete</strong>: Removes vertices, edges, and records.</li>
<li><strong>select</strong>: Fetches records by query.</li>
</ul>
<h3 id="create"><a class="header" href="#create">Create</a></h3>
<p>Creation queries in OrientJS are those used in creating vertex and edge records on a Graph Database. Given the added complexity of regular or lightweight edges running between the vertices, adding records is a little more complicated than the insert() method you might use otherwise.</p>
<p>The creation query method is comparable to the <a href="../sql/SQL-Create-Vertex.html"><code>CREATE VERTEX</code></a> and <a href="../sql/SQL-Create-Edge.html"><code>CREATE EDGE</code></a> commands on the OrientDB Console.</p>
<p>In OrientJS, creating vertices and edges uses the create() method. The examples below operate on a database of baseball statistics, which has been initialized on the db variable.</p>
<h4 id="creating-vertices"><a class="header" href="#creating-vertices">Creating Vertices</a></h4>
<p>Create an empty vertex on the <code>Player</code> vertex class:</p>
<pre><code class="language-js">session.create("VERTEX", `Player`).one()
	.then(results =&gt; {
		console.log(results);
	});
</code></pre>
<p>Create a vertex with properties:</p>
<pre><code class="language-js">session.create("VERTEX", "Player")
	.set({
		name: "Ty Cobb",
		birthDate: "1886-12-18",
		deathDate: "1961-7-17",
		batted: "left",
		threw: "right"
	})
	.one()
	.then((player)=&gt; {
		console.log(player);
	});
</code></pre>
<h4 id="creating-edges"><a class="header" href="#creating-edges">Creating Edges</a></h4>
<p>Creating edges to connect two vertices follows the same pattern as creating vertices, with the addition of <code>from()</code> and <code>to()</code> methods to show the edge direction.</p>
<p>For instance, consider an edge class <code>PlaysFor</code> that you use to connect player and team vertices.  Using it, you might create a simple edge that simply establishes the connection:</p>
<pre><code class="language-js">session.create("EDGE", "PlaysFor")
	.from("#12:12").to("#12:13")
	.one()
	.then(edge =&gt; {
		console.log(edge);
	});
</code></pre>
<p>This creates an edge between the player Ty Cobb, (#12:12), and the Detroit Tigers, (#12:13).  While this approach may be useful with players that stay with the same team, many don't.  In order to account for this, you would need to define properties on the edge.</p>
<pre><code class="language-js">session.create("EDGE", "PlaysFor")
	.from("#12:12").to("#12:13")
	.set({
		startYear: "1905",
		endYear: "1926"
	})
	.one()
	.then(edge =&gt; {
		console.log(edge);
	});
</code></pre>
<p>Now, whenever you build queries to show the players for a team, you can include conditionals to only show what teams they played for in a given year.</p>
<h3 id="insert"><a class="header" href="#insert">Insert</a></h3>
<p>Insertion queries in OrientJS are those that add records of a given class into the database.  The insertion query method is comparable to the <a href="../sql/SQL-Insert.html"><code>INSERT</code></a> commands on the OrientDB Console.</p>
<p>Example</p>
<p>In OrientJS, inserting data into the database uses the <code>insert()</code> method.  For instance, say that you want to add batting averages, runs and runs batted in for Ty Cobb.</p>
<pre><code class="language-js">session.insert().into("Player")
	.set({
		ba: 0.367,
		r: 2246,
		rbi: 1938
	})
	.one()
	.then((player) =&gt; {
		console.log(player);
	});
</code></pre>
<h5 id="raw-expressions"><a class="header" href="#raw-expressions">Raw Expressions</a></h5>
<pre><code>session.insert().into('Player')
	.set({
		uuid : session.rawExpression("format('%s',uuid())"),
	  	ba:  0.367,
	  	r:   2246,
	  	rbi: 1938
	}).one().then((player)=&gt;{
	   console.log(player)
	});
</code></pre>
<p>Generated Query</p>
<pre><code class="language-SQL">INSERT INTO Player SET uuid = format('%s',uuid()), ba = 0.367, r = 2246, rbi = 1938

</code></pre>
<h3 id="update"><a class="header" href="#update">Update</a></h3>
<p>Update queries in OrientJS are those used in changing or otherwise modifying existing records in the database.  The method is comparable to the <a href="../sql/SQL-Update.html"><code>UPDATE</code></a> command on the OrientDB Console.</p>
<p>In OrientJS, updating records works through the <code>update()</code> method.  The examples below operate on a database of baseball statistics, which has been initialized on the <code>session</code> variable.</p>
<h3 id="updating-records"><a class="header" href="#updating-records">Updating Records</a></h3>
<p>When the record already exists in the database, you can update the content to modify the current values stored on the class.</p>
<p>Consider the case where you want to update player data after a game.  For instance, last night the Boston Red Sox played and you want to update the batting average for the player Tito Ortiz, who has a Record ID #12:97.</p>
<pre><code>session.update("#12:97")
	.set({
		ba: 3.1
	})
	.one()
	.then(update =&gt; {
		console.log("Records Updated:", update);
	});
</code></pre>
<p>If you don't know the RecordID, alternatevily and more likely you can update with a where condition, for example on the name of the player.</p>
<pre><code class="language-js">session.update("Player")
	.set({
		ba: 3.1
	})
	.where({ name: "Ty Cobb" })
	.one()
	.then(update =&gt; {
		console.log("Records Updated:", update);
	});
</code></pre>
<h3 id="delete"><a class="header" href="#delete">Delete</a></h3>
<p>Deletion queries in OrientJS are those used in removing records from the database.  It can also account for edges between vertices, updating the graph to maintain its consistency.</p>
<p>The deletion query method is comparable to <a href="../sql/SQL-Delete.html"><code>DELETE</code></a>, <a href="../sql/SQL-Delete-Vertex.html"><code>DELETE VERTEX</code></a> and the <a href="../sql/SQL-Delete-Edge.html"><code>DELETE EDGE</code></a> statements.</p>
<p>In OrientJS, deletions use the <code>delete()</code> method.  The examples below operate on a database of baseball statistics, which has been initialized on the <code>session</code> variable.</p>
<h4 id="deleting-vertices"><a class="header" href="#deleting-vertices">Deleting Vertices</a></h4>
<p>With Graph Databases, deleting vertices is a little more complicated than the normal process of deleting records. You need to tell OrientDB that you want to delete a vertex to ensure that it takes the additional steps necessary to update the connecting edges.</p>
<p>For instance you want to remove the player Ty Cobb.</p>
<pre><code class="language-js">session.delete("VERTEX", "Player")
	.where({ name: "Ty Cobb" })
	.one()
	.then((del)=&gt; {
		console.log("Records Deleted: " + del);
	});
</code></pre>
<h4 id="deleting-edges"><a class="header" href="#deleting-edges">Deleting Edges</a></h4>
<p>When deleting edges, you need to define the vertices that the edge connects.  For instance, consider the case where you have a bad entry on the <code>playsFor</code> edge, where you have Ty Cobb assigned to the Chicago Cubs.  Ty Cobb has a Record ID of #12:12, the Chicago Cubs #12:54.</p>
<pre><code class="language-js">session.delete('EDGE', 'PlaysFor')
	.from('#12:12').to('#12:54')
	.one()
	.then((del)=&gt;{
	     console.log('Records Deleted: ' + del);
	  }
	);
</code></pre>
<h4 id="deleting-records"><a class="header" href="#deleting-records">Deleting Records</a></h4>
<p>In order to delete records in a given class, you need to define a conditional value that tells OrientDB the specific records in the class that you want to delete.  When working from the Console, you would use the <a href="../sql/SQL-Where.html"><code>WHERE</code></a> clause.  In OrientJS, set the <code>where()</code> method.</p>
<pre><code class="language-js">session.delete().from('Player')
	.where('@rid = #12:84').limit(1).scalar()
	.then((del)=&gt;{
	     console.log('Records Deleted: ' + del);
	  }
	);
</code></pre>
<h3 id="select"><a class="header" href="#select">Select</a></h3>
<p>Selection queries in OrientJS are those used to fetch data from the database, so that you can operate on it with your application.  The method is comparable to the <a href="../sql/SQL-Query.html"><code>SELECT</code></a> command in the OrientDB Console.</p>
<p>In OrientJS, fetching data from the database uses the <code>select()</code> method.  The examples below operate on a database of baseball statistics, which has been initialized on the <code>db</code> variable.</p>
<h4 id="selecting-records"><a class="header" href="#selecting-records">Selecting Records</a></h4>
<p>Use the <code>select()</code> method to fetch records from the database.  For instance, say you want a lit of all players with a batting average of .300.</p>
<pre><code class="language-js">session.select().from("Player")
	.where({
		ba: 0.3
	})
	.all()
	.then(function(select) {
		console.log("Hitters:", select);
	});
</code></pre>
<h4 id="custom-where"><a class="header" href="#custom-where">Custom Where</a></h4>
<p>The where clause can take a JSON object for expressing condition.
For more complex condition the where clause can take a string with
custom conditions and pass eventual parameters in one of the selected
query terminator (one/all/stream/scalar)</p>
<pre><code class="language-js">session.select().from("Player")
	.where("ba &gt;= :ba")
	.all({ ba : 0.3})
	.then((select) =&gt; {
		console.log("Hitters:", select);
	});
</code></pre>
<h4 id="using-expressions"><a class="header" href="#using-expressions">Using Expressions</a></h4>
<p>In the event that you would like to return only certain properties on the class or use OrientDB functions, you can pass the expression as an argument to the <code>select()</code> method.</p>
<p>For instance, say you want to know how many players threw right and batted left:</p>
<pre><code class="language-js">session.select("count(*)").from("Player")
	.where({
		threw: "right",
		batted: "left"
	})
	.scalar()
	.then((select) =&gt; {
		console.log("Total:", select);
	});
</code></pre>
<h4 id="returning-specific-fields"><a class="header" href="#returning-specific-fields">Returning Specific Fields</a></h4>
<p>Similar to expressions, by passing arguments to the method you can define a specific field that you want to return.  For instance, say you want to list the teams in your baseball database, such as in building links on a directory page.</p>
<pre><code class="language-js">session.select("name").from("Teams")
	.all()
	.then((select)=&gt; {
		console.log("Loading Teams:", select);
	});
</code></pre>
<h4 id="specifying-default-values"><a class="header" href="#specifying-default-values">Specifying Default Values</a></h4>
<p>Occasionally, you may encounter issues where your queries return empty fields.  In the event that this creates issues for how your application renders data, you can define default values for certain fields as OrientJS sets them on the variable.</p>
<p>For instance, in the example of the baseball database, consider a case where for some historical players the data is either currently incomplete or entirely unavailable. Rather than serving null values, you can set default values using the <code>defaults()</code> method.</p>
<pre><code class="language-js">session.select("name").from("Player")
	.defaults({
		throws: "Unknown",
		bats: "Unknown"
	}).all()
	.then(players =&gt; {
		console.log(players);
	});
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../orientjs/Client.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../pyorient/PyOrient.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../orientjs/Client.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../pyorient/PyOrient.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
