<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Apache TinkerPop 3 - OrientDB</title>


        <!-- Custom HTML head -->

        <meta name="description" content="OrientDB documentation">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">OrientDB</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <p>#OrientDB with Apache TinkerPop 3
<strong>(since v 3.0)</strong></p>
<p>OrientDB adheres to the <a href="http://tinkerpop.apache.org">Apache TinkerPop</a> standard and implements TinkerPop Stack interfaces.</p>
<p>In versions prior to 3.0, OrientDB uses the <a href="https://github.com/tinkerpop/blueprints">TinkerPop 2.x</a> implementation as the default for <a href="../java/Graph-Database-Tinkerpop.html">Java Graph API</a>.</p>
<p>Starting from version 3.0, OrientDB ships its own
APIs for handling Graphs (<a href="../java/Java-MultiModel-API.html">Multi-Model API</a>). Those APIs are used to implement the TinkerPop 3 interfaces.</p>
<p>The OrientDB TinkerPop development happens <a href="https://github.com/orientechnologies/orientdb-gremlin">here</a></p>
<ul>
<li><a href="#installation">Installation</a></li>
<li><a href="">Gremlin Console</a></li>
<li><a href="">Gremlin Server</a></li>
<li><a href="">Graph API</a></li>
</ul>
<h2 id="installation"><a class="header" href="#installation">Installation</a></h2>
<p>Since TinkerPop stack has been removed as a dependency from the OrientDB Community Edition, starting with version 3.0 it will be available for <a href="http://orientdb.com/download">download</a> as an Apache TinkerPop 3 enabled edition of OrientDB based on the Community Edition.</p>
<p>It contains all the features of the OrientDB Community Edition plus the integration with the Tinkerpop stack:</p>
<ul>
<li><a href="#gremlin-console">Gremlin Console</a></li>
<li><a href="#gremlin-server">Gremlin Server</a></li>
<li><a href="#gremlin-server">Gremlin Driver</a></li>
</ul>
<h3 id="source-code-installation"><a class="header" href="#source-code-installation">Source Code Installation</a></h3>
<p>In addition to the binary packages, you can compile the OrientDB TinkerPop enabled distribution from the source code.
This process requires that you install <a href="http://www.git-scm.com/">Git</a> and <a href="https://maven.apache.org/">Apache Maven</a> on your system.</p>
<p>As a pre-requirement, you have to build the same branch for OrientDB core distribution:</p>
<pre><code class="language-sh">$ git clone https://github.com/orientechnologies/orientdb
$ cd orientdb
$ git checkout develop
$ mvn clean install -DskipTests
$ cd ..
</code></pre>
<p>Then you can proceed and build <code>orientdb-gremlin</code></p>
<pre><code class="language-sh">$ git clone https://github.com/orientechnologies/orientdb-gremlin
$ cd orientdb-gremlin
$ git checkout develop
$ mvn clean install
</code></pre>
<p>It is possible to skip tests:</p>
<pre><code class="language-sh">$ mvn clean install -DskipTests
</code></pre>
<p>This project follows the branching system of <a href="../admin/installation/Installation-from-Source.html">OrientDB</a>.</p>
<p>The build process installs all jars in the local maven repository and creates archives under the <code>distribution</code> module inside the <code>target</code> directory. At the time of writing, building from branch <code>develop</code> gave:</p>
<pre><code class="language-sh">$ls -l distribution/target/
total 266640
drwxr-xr-x   2 staff  staff    68B Mar 21 13:07 archive-tmp/
drwxr-xr-x   3 staff  staff   102B Mar 21 13:07 dependency-maven-plugin-markers/
drwxr-xr-x  12 staff  staff   408B Mar 21 13:07 orientdb-community-3.0.0-SNAPSHOT/
drwxr-xr-x   3 staff  staff   102B Mar 21 13:07 orientdb-gremlin-community-3.0.0-SNAPSHOT.dir/
-rw-r--r--   1 staff  staff    65M Mar 21 13:08 orientdb-gremlin-community-3.0.0-SNAPSHOT.tar.gz
-rw-r--r--   1 staff  staff    65M Mar 21 13:08 orientdb-gremlin-community-3.0.0-SNAPSHOT.zip
$
</code></pre>
<p>The directory <code>orientdb-gremlin-community-3.0.0-SNAPSHOT.dir</code> contains the OrientDB Gremlin distribution uncompressed.</p>
<h2 id="gremlin-console"><a class="header" href="#gremlin-console">Gremlin Console</a></h2>
<p>The Gremlin Console is an interactive terminal or REPL that can be used to traverse graphs and interact with the data that they contain. For more information about it see the documentation <a href="http://tinkerpop.apache.org/docs/current/reference/#gremlin-console">here</a></p>
<p>To start the Gremlin console run <strong>the gremlin.sh</strong> (or gremlin.bat on Windows OS) script located in the <strong>bin</strong> directory of the OrientDB Gremlin Distribution</p>
<pre><code>$ ./gremlin.sh 

         \,,,/
         (o o)
-----oOOo-(3)-oOOo-----
plugin activated: tinkerpop.orientdb
gremlin&gt; 
</code></pre>
<p>Alternatively if you downloaded the Gremlin Console from the Apache Tinkerpop <a href="https://tinkerpop.apache.org/">Site</a>, just install the OrientDB Gremlin Plugin with</p>
<pre><code>gremlin&gt; :install com.orientechnologies orientdb-gremlin {version}
</code></pre>
<p>and then activate it</p>
<pre><code>gremlin&gt; :plugin use tinkerpop.orientdb
</code></pre>
<h3 id="open-the-graph-database"><a class="header" href="#open-the-graph-database">Open the graph database</a></h3>
<p>Before playing with <a href="http://gremlindocs.com">Gremlin</a> you need a valid <a href="../java/Tutorial-Java.html#use-case-graph-api"><strong>OrientGraph</strong></a> instance that points to an OrientDB database. To know all the database types look at <a href="../datamodeling/Concepts.html#database-url">Storage types</a>.</p>
<p>When you're working with a local or an in-memory database, if the database does not exist it's created for you automatically. Using the remote connection you need to create the database on the target server before using it. This is due to security restrictions.</p>
<p>Once created the <strong><a href="#orientdb-tinkerpop-graph-api">OrientGraph</a></strong> instance with a proper URL is necessary to assign it to a variable. <a href="https://tinkerpop.apache.org/gremlin.html">Gremlin</a> is written in Groovy, so it supports all the Groovy syntax, and both can be mixed to create very powerful scripts!</p>
<p>Example with a memory database (see below for more information about it):</p>
<pre><code class="language-java">gremlin&gt; graph = OrientGraph.open();
==&gt;orientgraph[memory:orientdb-0.5772652169975153]
</code></pre>
<p>Some useful links:</p>
<ul>
<li><a href="http://tinkerpop.apache.org/docs/current/reference/#graph">The Graph</a></li>
<li><a href="http://tinkerpop.apache.org/docs/current/reference/#traversal">All available steps</a></li>
</ul>
<h4 id="working-with-in-memory-database"><a class="header" href="#working-with-in-memory-database">Working with in-memory database</a></h4>
<p>In this mode the database is volatile and all the changes will be not persistent. Use this in a clustered configuration (the database life is assured by the cluster itself) or just for test.</p>
<pre><code class="language-java">gremlin&gt; graph = OrientGraph.open()
==&gt;orientgraph[memory:orientdb-0.4274754723616194]
</code></pre>
<h4 id="working-with-local-database"><a class="header" href="#working-with-local-database">Working with local database</a></h4>
<p>This is the most often used mode. The console opens and locks the database for exclusive use. This doesn't require starting an OrientDB server.</p>
<pre><code class="language-java">gremlin&gt; graph = OrientGraph.open("embedded:/tmp/gremlin/demo");
==&gt;orientgraph[plocal:/tmp/gremlin/demo]
</code></pre>
<h4 id="working-with-a-remote-database"><a class="header" href="#working-with-a-remote-database">Working with a remote database</a></h4>
<p>To open a database on a remote server be sure the server is up and running first. To start the server just launch <strong>server.sh</strong> (or server.bat on Windows OS) script. For more information look at <a href="../internals/DB-Server.html">OrientDB Server</a></p>
<pre><code class="language-java">gremlin&gt; graph = OrientGraph.open("remote:localhost/demodb");
==&gt;orientgraph[remote:localhost/demodb]
</code></pre>
<h4 id="use-security"><a class="header" href="#use-security">Use security</a></h4>
<p>OrientDB supports security by creating multiple users and roles associated with certain privileges. To know more look at <a href="../security/Security.html">Security</a>. To open the graph database with a different user than the default, pass the user and password as additional parameters:</p>
<pre><code class="language-java">gremlin&gt; graph = OrientGraph.open("remote:localhost/demodb","reader","reader");
==&gt;orientgraph[remote:localhost/demodb]
</code></pre>
<h4 id="with-configuration"><a class="header" href="#with-configuration">With Configuration</a></h4>
<pre><code>gremlin&gt; config = new BaseConfiguration()
==&gt;org.apache.commons.configuration.BaseConfiguration@2d38edfd
gremlin&gt; config.setProperty("orient-url","remote:localhost/demodb")
==&gt;null
gremlin&gt; graph = OrientGraph.open(config)
==&gt;orientgraph[remote:localhost/demodb]
</code></pre>
<p>Available configurations are :</p>
<ul>
<li><strong>orient-url</strong>: Connection URL.</li>
<li><strong>orient-user</strong>: Database User.</li>
<li><strong>orient-pass</strong>: Database Password.</li>
<li><strong>orient-transactional</strong>: Transactional. Configuration. If true the <code>OrientGraph</code> instance will support transactions (Disabled by default).</li>
</ul>
<h3 id="mutating-the-graph"><a class="header" href="#mutating-the-graph">Mutating the Graph</a></h3>
<h4 id="create-a-new-vertex"><a class="header" href="#create-a-new-vertex">Create a new Vertex</a></h4>
<p>To create a new vertex, use the <strong>addVertex()</strong> method. The vertex will be created and a unique id will be displayed as the return value.</p>
<pre><code class="language-java">graph.addVertex();
==&gt;v[#5:0]
</code></pre>
<h4 id="create-an-edge"><a class="header" href="#create-an-edge">Create an edge</a></h4>
<p>To create a new edge between two vertices, use the <strong>v1.addEdge(label, v2)</strong> method. The edge will be created with the label specified.</p>
<p>In the example below two vertices are created and assigned to a variable (Gremlin is based on Groovy), then an edge is created between them.</p>
<pre><code class="language-java">gremlin&gt;  v1 = graph.addVertex();
==&gt;v[#10:0]

gremlin&gt;  v2 = graph.addVertex();
==&gt;v[#11:0]

gremlin&gt; e = v1.addEdge('friend',v2)
==&gt;e[#17:0][#10:0-friend-&gt;#11:0]
</code></pre>
<h4 id="close-the-database"><a class="header" href="#close-the-database">Close the database</a></h4>
<p>To close a graph use the <strong>close()</strong> method:</p>
<pre><code class="language-java">gremlin&gt; graph.close()
==&gt;null
</code></pre>
<p>This is not strictly necessary because OrientDB always closes the database when the Gremlin Console quits.</p>
<h4 id="transactions"><a class="header" href="#transactions">Transactions</a></h4>
<p>OrientGraph supports Transactions. By default Tx are disabled. Use configuration to enable it.</p>
<pre><code>gremlin&gt; config = new BaseConfiguration()
==&gt;org.apache.commons.configuration.BaseConfiguration@2d38edfd
gremlin&gt; config.setProperty("orient-url","remote:localhost/demodb")
==&gt;null
gremlin&gt; config.setProperty("orient-transactional",true)
==&gt;null
gremlin&gt; graph = OrientGraph.open(config)
==&gt;orientgraph[remote:localhost/demodb]
</code></pre>
<p>When using transactions OrientDB assigns a temporary identifier to each vertex and edge that is created.
use <code>graph.tx().commit()</code> to save them.</p>
<p>Transaction Example</p>
<pre><code>gremlin&gt; config = new BaseConfiguration()
==&gt;org.apache.commons.configuration.BaseConfiguration@6b7d1df8
gremlin&gt; config.setProperty("orient-url","remote:localhost/demodb")
==&gt;null
gremlin&gt; config.setProperty("orient-transactional",true)
==&gt;null
gremlin&gt; graph = OrientGraph.open(config)
==&gt;orientgraph[remote:localhost/demodb]
gremlin&gt; graph.tx().isOpen()
==&gt;true
gremlin&gt; v1 = graph.addVertex()
==&gt;v[#-1:-2]
gremlin&gt; v2 = graph.addVertex()
==&gt;v[#-1:-3]
gremlin&gt; e = v1.addEdge("friends",v2)
==&gt;e[#-1:-4][#-1:-2-friends-&gt;#-1:-3]
gremlin&gt; graph.tx().commit()
==&gt;null
</code></pre>
<h3 id="traversal"><a class="header" href="#traversal">Traversal</a></h3>
<p>The power of Gremlin is in traversal. Once you have a graph loaded in your database you can traverse it in many different ways. For more info about traversal with Gremlin see <a href="http://tinkerpop.apache.org/docs/current/reference/#traversal">here</a></p>
<p>The entry point for traversal is a TraversalSource that can be easily obtained by an opened OrientGraph instance with:</p>
<pre><code>gremlin&gt; graph = OrientGraph.open()
==&gt;orientgraph[memory:orientdb-0.41138060448051794]
gremlin&gt; g = graph.traversal()
==&gt;graphtraversalsource[orientgraph[memory:orientdb-0.41138060448051794], standard]
</code></pre>
<h4 id="retrieve-a-vertex"><a class="header" href="#retrieve-a-vertex">Retrieve a vertex</a></h4>
<p>To retrieve a vertex by its ID, use the <strong>V(id)</strong> method passing the <a href="../datamodeling/Concepts.html#record-id">RecordId</a> as an argument (with or without the prefix '#'). This example retrieves the first vertex created in the above example.</p>
<pre><code class="language-java">gremlin&gt; g.V('#33:0')
==&gt;v[#33:0]
</code></pre>
<h4 id="get-all-the-vertices"><a class="header" href="#get-all-the-vertices">Get all the vertices</a></h4>
<p>To retrieve all the vertices in the opened graph use <strong>.V()</strong> (V in upper-case):</p>
<pre><code class="language-java">gremlin&gt; g.V()
==&gt;v[#33:0]
==&gt;v[#33:1]
==&gt;v[#33:2]
==&gt;v[#33:3]
</code></pre>
<h4 id="retrieve-an-edge"><a class="header" href="#retrieve-an-edge">Retrieve an edge</a></h4>
<p>Retrieving an edge is very similar to retrieving a vertex.  Use the <code>E(id)</code> method passing the <a href="../datamodeling/Concepts.html#record-id">RecordId</a> as an argument (with or without the prefix '#'). This example retrieves the first edge created in the previous example.</p>
<pre><code class="language-java">gremlin&gt; g.E('145:0')
==&gt;e[#145:0][#121:0-IsFromCountry-&gt;#33:29]
</code></pre>
<h4 id="get-all-the-edges"><a class="header" href="#get-all-the-edges">Get all the edges</a></h4>
<p>To retrieve all the edges in the opened graph use <code>.E()</code> (E in upper-case):</p>
<pre><code class="language-java">gremlin&gt; g.E()
==&gt;e[#145:0][#121:0-IsFromCountry-&gt;#33:29]
==&gt;e[#145:1][#121:1-IsFromCountry-&gt;#40:11]
==&gt;e[#145:2][#121:2-IsFromCountry-&gt;#37:0]
</code></pre>
<h4 id="basic-traversal"><a class="header" href="#basic-traversal">Basic Traversal</a></h4>
<p>To display all the outgoing edges of a vertex use <code>.outE(&lt;label&gt;)</code> .
Label is optional and if passed the outgoing edges will be filtered by that label</p>
<p>Example:</p>
<pre><code class="language-java">gremlin&gt; g.V('#41:1').outE()
==&gt;e[#221:6][#41:1-HasFriend-&gt;#42:1]
==&gt;e[#222:6][#41:1-HasFriend-&gt;#43:1]
</code></pre>
<p>To display all the incoming edges of a vertex use <code>.inE(&lt;label&gt;)</code>. Example:</p>
<pre><code class="language-java">gremlin&gt; g.V('#41:1').inE()
==&gt;e[#224:0][#41:0-HasFriend-&gt;#41:1]
==&gt;e[#217:2][#42:0-HasFriend-&gt;#41:1]
==&gt;e[#217:3][#43:0-HasFriend-&gt;#41:1]
==&gt;e[#224:3][#44:0-HasFriend-&gt;#41:1]
==&gt;e[#222:4][#45:0-HasFriend-&gt;#41:1]
==&gt;e[#219:5][#46:0-HasFriend-&gt;#41:1]
==&gt;e[#223:5][#47:0-HasFriend-&gt;#41:1]
==&gt;e[#218:6][#48:0-HasFriend-&gt;#41:1]
==&gt;e[#185:0][#121:0-HasProfile-&gt;#41:1]
</code></pre>
<p>For more information look at the <a href="http://tinkerpop.apache.org/docs/current/reference/#traversal">Gremlin Traversal</a>.</p>
<h4 id="filter-results"><a class="header" href="#filter-results">Filter results</a></h4>
<p>This example returns all the outgoing edges of all the vertices with label equal to 'friend'.</p>
<pre><code class="language-java">gremlin&gt; g.V('#41:1').inE('HasProfile')
==&gt;e[#185:0][#121:0-HasProfile-&gt;#41:1]
gremlin&gt; 
</code></pre>
<h4 id="create-complex-paths"><a class="header" href="#create-complex-paths">Create complex paths</a></h4>
<p><a href="https://tinkerpop.apache.org/gremlin.html">Gremlin</a> allows you to concatenate expressions to create more complex traversals in a single line:</p>
<pre><code class="language-java">g.V().in().out()
</code></pre>
<p>Of course this could be much more complex. Below is an example with the graph taken from the official documentation:</p>
<pre><code class="language-java">gremlin&gt; g.V('44:0').out('HasFriend').out('HasFriend').values('Name').dedup()
==&gt;Frank
==&gt;Emanuele
==&gt;Paolo
==&gt;Colin
==&gt;Andrey
==&gt;Sergey
gremlin&gt; 
</code></pre>
<h2 id="gremlin-server"><a class="header" href="#gremlin-server">Gremlin Server</a></h2>
<p>There are two ways to use OrientDB inside the Gremlin Server</p>
<ul>
<li>Use the OrientDB-TP3 distribution that embed the Gremlin Server</li>
<li>Install the OrientDB-Gremlin Driver into a GremlinServer</li>
</ul>
<h3 id="orientdb-tp3"><a class="header" href="#orientdb-tp3">OrientDB-TP3</a></h3>
<p>Download the latest version of OrientDB-TP3 <a href="https://orientdb.com/download-2/">here</a>.
and start OrientDB to automatically start the embedded Gremlin Server.
The configuration of the Gremlin Server is in <code>$ORIENTDB_HOME/config</code>.</p>
<p>When using the embedded version by default the Authentication manager authenticate the users against OrientDB server user
with permission <code>gremlin.server</code>.</p>
<h3 id="install-orientdb-gremlin"><a class="header" href="#install-orientdb-gremlin">Install OrientDB-Gremlin</a></h3>
<p>Download the latest Gremlin Server distribution <a href="https://tinkerpop.apache.org/">here</a></p>
<p>and then install the OrientDB Gremlin driver with</p>
<pre><code class="language-sh">bin/gremlin-server.sh -i com.orientechnologies orientdb-gremlin ${version}
</code></pre>
<h4 id="orientdb-gremlin-server-configuration"><a class="header" href="#orientdb-gremlin-server-configuration">OrientDB Gremlin Server configuration</a></h4>
<p>YAML configuration example (save as <code>gremlin-server.yaml</code>)</p>
<pre><code>host: localhost
port: 8182
scriptEvaluationTimeout: 30000
channelizer: org.apache.tinkerpop.gremlin.server.channel.WebSocketChannelizer
graphs: {
  graph : conf/orientdb-empty.properties
}
scriptEngines: {
  gremlin-groovy: {
    plugins: { org.apache.tinkerpop.gremlin.server.jsr223.GremlinServerGremlinPlugin: {},
               org.apache.tinkerpop.gremlin.orientdb.jsr223.OrientDBGremlinPlugin: {},
               org.apache.tinkerpop.gremlin.jsr223.ImportGremlinPlugin: {classImports: [java.lang.Math], methodImports: [java.lang.Math#*]},
               org.apache.tinkerpop.gremlin.jsr223.ScriptFileGremlinPlugin: {files: [ scripts/empty-sample.groovy]}}}}
serializers:
  - { className: org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0, config: { ioRegistries: [org.apache.tinkerpop.gremlin.orientdb.io.OrientIoRegistry] }}             # application/vnd.gremlin-v3.0+gryo
  - { className: org.apache.tinkerpop.gremlin.driver.ser.GryoMessageSerializerV3d0, config: { serializeResultToString: true }}                                                                       # application/vnd.gremlin-v3.0+gryo-stringd
  - { className: org.apache.tinkerpop.gremlin.driver.ser.GraphSONMessageSerializerV3d0, config: { ioRegistries: [org.apache.tinkerpop.gremlin.orientdb.io.OrientIoRegistry] }}         # application/json
processors:
  - { className: org.apache.tinkerpop.gremlin.server.op.session.SessionOpProcessor, config: { sessionTimeout: 28800000 }}
  - { className: org.apache.tinkerpop.gremlin.server.op.traversal.TraversalOpProcessor, config: { cacheExpirationTime: 600000, cacheMaxSize: 1000 }}
metrics: {
  consoleReporter: {enabled: true, interval: 180000},
  csvReporter: {enabled: true, interval: 180000, fileName: /tmp/gremlin-server-metrics.csv},
  jmxReporter: {enabled: true},
  slf4jReporter: {enabled: true, interval: 180000}}
strictTransactionManagement: false
maxInitialLineLength: 4096
maxHeaderSize: 8192
maxChunkSize: 8192
maxContentLength: 65536
maxAccumulationBufferComponents: 1024
resultIterationBatchSize: 64
writeBufferLowWaterMark: 32768
writeBufferHighWaterMark: 65536
ssl: {
  enabled: false}

</code></pre>
<p>Graph Configuration properties example (e.g. save as <code>orientdb-empty.properties</code>. It has to be the one referenced in the <code>gremlin-server.yaml</code> file)</p>
<pre><code>gremlin.graph=org.apache.tinkerpop.gremlin.orientdb.OrientFactory
orient-url=plocal:/tmp/graph
orient-user=admin
orient-pass=admin
</code></pre>
<blockquote>
<p><strong>Note</strong>: currently <code>https://mvnrepository.com/artifact/com.github.jnr/jffi/1.2.23</code> is missing. Download and add to <code>lib</code> or <code>plugins</code> folder.</p>
</blockquote>
<h2 id="orientdb-tinkerpop-graph-api"><a class="header" href="#orientdb-tinkerpop-graph-api">OrientDB TinkerPop Graph API</a></h2>
<p>In order to use the OrientDB TinkerPop Graph API implementation, you need to create an instance of the <code>OrientGraph</code> class. If the database already exists, the Graph API opens it.</p>
<blockquote>
<p><strong>NOTE</strong>: When creating a database through the Graph API, you can only create <code>PLocal</code> and <code>Memory</code> databases.  Remote databases must already exist.</p>
</blockquote>
<blockquote>
<p><strong>NOTE</strong>: In v. 2.2 and following releases, when using PLocal or Memory,please set MaxDirectMemorySize (JVM setting) to a high value, like 512g <code>-XX:MaxDirectMemorySize=512g</code></p>
</blockquote>
<p>When building multi-threaded application, use one instance of <code>OrientGraph</code> per thread.  Bear in mind that all graph components, such as vertices and edges, are not thread safe.  So, sharing them between threads may result in unpredictable results.</p>
<p>Remember to always close the graph instance when you are done with it, using the <code>.close()</code> method.</p>
<h4 id="working-with-in-memory-database-1"><a class="header" href="#working-with-in-memory-database-1">Working with in-memory database</a></h4>
<pre><code class="language-java">OrientGraph graph = OrientGraph.open();
try {
  ...
} finally {
  graph.close();
}
</code></pre>
<h4 id="working-with-local-database-1"><a class="header" href="#working-with-local-database-1">Working with local database</a></h4>
<pre><code class="language-java">OrientGraph graph = OrientGraph.open("embedded:/tmp/gremlin/demo");
try {
  ...
} finally {
  graph.close();
}
</code></pre>
<h4 id="working-with-remote-database"><a class="header" href="#working-with-remote-database">Working with remote database</a></h4>
<pre><code class="language-java">OrientGraph graph = OrientGraph.open("remote:localhost/demodb");
try {
  ...
} finally {
  graph.close();
}
</code></pre>
<h4 id="using-the-graph-factory"><a class="header" href="#using-the-graph-factory">Using the Graph Factory</a></h4>
<p>The <code>OrientGraphFactory</code> act as a factory for <code>OrientGraph</code> instances
Using a Graph Factory in your application is relatively straightforward.  First, create and configure a factory instance using the <code>OrientGraphFactory</code> class.  Then, use the factory whenever you need to create an <code>OrientGraph</code> instance and shut it down to return it to the pool.  When you're done with the factory, close it to release all instances and free up system resources.</p>
<pre><code class="language-java">OrientGraphFactory factory = new OrientGraphFactory("remote:localhost/demodb","admin","admin");
</code></pre>
<p>Then you can:</p>
<ul>
<li>retrieve a transactional instance, use the getTx() method on your factory object:</li>
</ul>
<pre><code class="language-java">OrientGraph txGraph = factory.getTx();
</code></pre>
<ul>
<li>retrieve a non-transactional instance, use the getNoTx() method on your factory object:</li>
</ul>
<pre><code>OrientGraph noTxGraph = factory.getNoTx();
</code></pre>
<h4 id="shutting-down-graph-instances"><a class="header" href="#shutting-down-graph-instances">Shutting Down Graph Instances</a></h4>
<p>When you're done with a Graph Database instance, you can return it to the pool by calling the <code>close()</code> method on the instance.  This method does not close the instance.  The instance remains open and available for the next requester:</p>
<pre><code class="language-java">graph.close();
</code></pre>
<h4 id="releasing-the-graph-factory"><a class="header" href="#releasing-the-graph-factory">Releasing the Graph Factory</a></h4>
<p>When you're ready to release all instances, call the <code>close()</code> method on the factory.  In the case of pool usage, this also frees up the system resources claimed by the pool:</p>
<pre><code class="language-java">factory.close();
</code></pre>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../java/Lightweight-Edges.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../java/Document-Database.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../java/Lightweight-Edges.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../java/Document-Database.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>


        
        <img referrerpolicy="unsafe-url" src="https://tglman.org/OrientDB/matomo.php?idsite=7&amp;rec=1" style="border:0" alt="" />


        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
